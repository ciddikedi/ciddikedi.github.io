<!doctype html><html lang=tr dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>BitLocker korumasını saniyeler içerisinde kırın! | ciddikedi</title>
<meta name=keywords content><meta name=description content="Giriş
Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim."><meta name=author content="Osman Bedrettin Yüce"><link rel=canonical href=https://ciddikedi.com/posts/tpm/><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://ciddikedi.com/images/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://ciddikedi.com/images/favicon16.png><link rel=icon type=image/png sizes=32x32 href=https://ciddikedi.com/images/favicon32.png><link rel=apple-touch-icon href=https://ciddikedi.com/apple-touch-icon.png><link rel=mask-icon href=https://ciddikedi.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=tr href=https://ciddikedi.com/posts/tpm/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z3HEVYS9VJ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z3HEVYS9VJ")}</script><meta property="og:title" content="BitLocker korumasını saniyeler içerisinde kırın!"><meta property="og:description" content="Giriş
Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim."><meta property="og:type" content="article"><meta property="og:url" content="https://ciddikedi.com/posts/tpm/"><meta property="og:image" content="https://ciddikedi.com/posts/tpm/images/tpm_cover.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-14T10:38:29+03:00"><meta property="article:modified_time" content="2025-05-14T10:38:29+03:00"><meta property="og:site_name" content="ciddikedi"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ciddikedi.com/posts/tpm/images/tpm_cover.jpg"><meta name=twitter:title content="BitLocker korumasını saniyeler içerisinde kırın!"><meta name=twitter:description content="Giriş
Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"gönderiler","item":"https://ciddikedi.com/posts/"},{"@type":"ListItem","position":2,"name":"BitLocker korumasını saniyeler içerisinde kırın!","item":"https://ciddikedi.com/posts/tpm/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"BitLocker korumasını saniyeler içerisinde kırın!","name":"BitLocker korumasını saniyeler içerisinde kırın!","description":"Giriş Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim.\n","keywords":[],"articleBody":"Giriş Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim.\nTPM nedir? Günümüzde birçok bilgisayarın anakartında gömülü bulunan bu küçük yonga özellikle Windows 11 ile birlikte çok daha popüler hale geldi. TPM, yani Trusted Platform Module olarak adlandırılan bu donanım tabanlı güvenlik bileşeni, sistemin güvenliğini sağlamak için kriptografik anahtarları güvenli bir şekilde saklar ve kullanır. TPM, dijital dünyada bir nevi kasa görevi görür ve içerisine bir şey koyduğunuzda onu dışarıdan doğrudan almanız mümkün değildir. Ancak sistem uygun koşullar altında bu kasayı açabilir. BitLocker gibi disk şifreleme teknolojileri de tam bu noktada TPM’in sunduğu güvenlik garantilerinden faydalanır.\nST33 yongasının donanım diyagramı. (Alıntı)\nDetaylarından daha ileride bahsedeceğim kurban bilgisayar, TPM olarak STMicroelectronics üretimi ST33ZP24AR28PVSP yongasını kullanıyor ve bu yonga basit bir devre elemanı olmaktan öte içerisinde 25 MHz hızında çalışan bir ARM SC300 işlemci barındırıyor. Yani TPM yongası sadece veri saklamıyor; aynı zamanda şifreleme, çözme ve kimlik doğrulama gibi işlemleri kendi içinde gerçekleştiriyor. Dolayısıyla bu durum TPM’in aktif bir güvenlik bileşeni olduğunun açık bir göstergesi.\nTasarlanan mimari, TPM’i bir nevi bağımsız bir güvenlik sistemi haline getiriyor. Başka bir deyişle sistemin güvenliği sadece işletim sisteminin veya uygulamaların kontrolüne bırakılmıyor, aynı zamanda donanım seviyesinde dış dünyadan izole bir işlemcinin kararlarına da bağlı oluyor. Kritik şifreleme ve şifre çözme işlemleri fiziksel olarak erişilemeyen dış müdahalelere karşı korumalı bir alanda gerçekleşiyor.\nNasıl Çalışır? TPM yongasının aslında kendi başına ayrı bir cumhuriyet olduğundan bahsetmiştik. Tam olarak nasıl çalıştığını anlayabilmek için birkaç temel bileşen hakkında fikir sahibi olunması gerekiyor.\nEK - Endorsement Key: Yonga üreticisi tarafından üretim sırasında donanım içerisine kalıcı olarak gömülen RSA anahtarıdır. Yonganın benzersiz olmasında rol oynar ve dışarı çıkartılamaz, değiştirilemez.\nSRK - Storage Root Key: TPM tarafından korunan tüm anahtarları şifrelemek için kullanılır. Cihaz ilk kurulduğunda oluşturulur ve dışarı çıkartılamaz. Değiştirilemez fakat yeniden üretilebilir.\nAK - Attestation Key: Sistemin açılış ölçümlerini imzalar ve güvenilirliğini doğrular. Değiştirilebilir ve yeniden oluşturulabilir.\nPCR - Platform Configuration Register: TPM üzerinde bulunan özel kayıt alanlarıdır. Sistemin açılış ölçümlerinin hash değerini tutar ve her açılışta teyit eder. Bu değerlerin içerisinde BIOS kodu, boot loader, Secure Boot gibi bilgiler yer alır ve eğer açılışta bu bilgiler eşleşmezse sistem açılmayı reddeder. Attestation Key bu alanı imzalar.\nRNG - Random Number Generator: Kriptografide tahmin edilemez rastgele sayı üretmek için kullanılır. Donanım temellidir ve anahtar üretimi, şifreleme işlemleri aşamalarında kullanılr.\nBunların dışında TPM yongası verileri şifrelemek için bünyesinde hem simetrik algoritmalar hem de asimetrik algoritmalar için donanımsal motorları barındırır. Böylelikle şifreleme ve şifre çözme işlemleri hem daha hızlı olur hem de bağımsız bir ortamda gerçekleştirildiği için daha güvenli olur. Kendine ait kilobyte seviyesinde küçük de olsa bir RAM bulunan bu yonga, bünyesinde barındırdığı şifreleri hiçbir şekilde dışarı çıkartmaz.\nSealing ve Unsealing TPM üzerinde sealing ve unsealing işlemleri, güvenli veri depolama ve veri koruma amacıyla kullanılan temel özelliklerdir. TPM’nin en önemli özelliklerinden biri verilerin yalnızca güvenli bir ortamda yani belirli bir şartlar sağlandığında erişilebilir olmasını garanti eden sealing ve unsealing işlevleridir.\nSealing: Verileri TPM üzerinde SRK kullanarak şifreler ve sistemin son durumunu PCR üzerine kaydederek sistemin güvenliğini garanti altına alır. Bir kere çalıştırılır. Örneğin; BitLocker kurulumunda ihtiyaç duyulan şifreli anahtarın üretilmesi bir sealing işlemidir.\nUnsealing: Şifrelenmiş verinin TPM üzerinde çözülmesi işlemidir. Sealing işlemi sırasında oluşturulan PCR koşulları sağlanıyorsa TPM veriyi açar ve sistemin kullanımına sunar. Sistem her boot olduğunda şifrelenmiş diske ait anahtarı kullanabilmek için çalıştırılır.\nBitLocker Windows işletim sistemlerinde kullanılan bir güvenlik özelliği olan BitLocker, disk üzerindeki verileri şifreler ve bilgisayarın çalınması veya bilgisayardaki diskin üçüncü şahısların eline geçmesi durumunda yetkisiz erişimin önüne geçer. Bilgisayara ait anakartın değiştirilmesi veya şifrelenmiş diskin farklı bir bilgisayara takılması durumunda sistem açılmayı reddeder. Güvenli ortam ve uygun koşullar sağlandığı sürece BitLocker, sisteme güvenerek disk alanını okunabilir hale getirir. Bu yöntemle yapılan şifreli disk okuma ve yazma işlemleri işlemcinin AES şifreleme hızlandırıcıları üzerinde yapılır ve performans kaybı göz ardı edilebilecek düzeydedir.\nTPM - BitLocker ilişkisi BitLocker esasında sadece bir disk şifreleme teknolojisi gibi gözükse de TPM gibi donanımsal bir güvenlik yongasıyla birlikte çalışır. TPM’in bu noktada iki tane görevi vardır. Birincisi üzerindeki SRK’yı kullanarak BitLocker anahtarını şifreler. İkinci görevi ise PCR koşullarını kontrol ederek sistem açıldığında şifrelenmiş anahtarı çözer. Biraz daha detaya girmek için bazı tanımlar hakkında fikir sahibi olmak gerekiyor.\nFVEK - Full Volume Encryption Key: Diskteki verinin tamamını şifrelemek için kullanılan asıl anahtardır. Veri şifrelemede kullanıldığı için AES algoritmasını kullanır.\nVMK - Volume Master Key: Asıl disk şifreleme anahtarı olan FVEK’i çözer. Diskin Volume Header’inde şifrelenmiş olarak saklanır. Sistem boot ettiğinde TPM tarafından çözülür ve RSA algoritmasını kullanır.\nRecovery Key: BitLocker kurulumu sırasında kullanıcıya verilen 48 haneli özel kurtarma anahtarıdır. TPM yapılandırması bozulduğunda veya disk üzerindeki veriler kurtarılmak istendiğinde kullanılır. Recovery Key, şifrelenmiş VMK’yı çözer.\nKısacası daha anlaşılır olması amacıyla basite indirmek gerekirse şifrelenmiş diskin sırasıyla çözülme aşamaları aşağıdaki gibidir.\nRecovery Key: 48 haneli parola Volume Header'daki VMK bloğu: Şifreli VMK Recovery Key + Şifreli VMK -\u003e Açık VMK Açık VMK + Şifreli FVEK -\u003e Açık FVEK Açık FVEK -\u003e NTFS verisi Özet niteliğindeki bu açıklama konuyu genel hatlarıyla anlamamıza yardımcı oldu ancak konunun teknik yönünü daha derinlemesine incelemek isteyenler için şimdi sürecin bir de uzuncasını inceleyelim. Sistemimizin daha modern olduğunu varsayarak Legacy BIOS yerine UEFI sürecinden bahsedeceğim.\nUEFI aşaması: Sistem güç verildiğinde çalışan ilk aşamadır. Temel donanımlar başlatılır ve bileşenler algılanır. Eğer şartlar uygunsa Boot Device Selection aşamasına geçilir. Boot edilecek disk bilgilerinin yanında bootloader bilgisi UEFI belleğinde saklanır. Aksi belirtilmediği sürece Windows için varsayılan boot manager \\EFI\\Microsoft\\Boot\\bootmgfw.efiyolundadır. UEFI uyumlu sistemler için FAT32 formatlı EFI partitionu olmak zorundadır ve eğer herhangi bir bootloader tanımı yapılmadıysa \\EFI\\Boot\\bootx64.efiyolu varsayılan olarak kullanılır. Boot Manager ve Loader: UEFI tarafından yüklenen bootmgfw.efi, hangi işletim sistemi veya hangi seçenekle devam edileceğine karar verir ve bootloader’i yani winload.efi‘yi çalıştırır. Bootloader sistemin başlaması için temel sürücülerin yanında fvevol.sys yani Full Volume Encryption Driver’i de belleğe yükler. TPM ile şifre çözme: Disk şifreleme sürücüsü öncelikle mevcut diskin Volume Header’ini okuyarak şifreli VMK’yı TPM’e gönderir ve şifre çözme talebinde bulunur. Eğer PCR üzerinde bulunan hash değerleri tutarlıysa diskteki şifreli VMK, TPM üzerindeki SRK kullanılarak çözülür ve sisteme geri gönderilir. Sürücü, şifresi çözülmüş VMK’yı kullarak FVEK’i çözer ve diski okunabilir hale getirir. Windows yüklenmesi: Her şey uygun olduğuna göre artık disk üzerinde bulunan ntoskrnl.exe çekirdeği çalıştırılır ve kontrol işletim sistemine bırakılır. Donanım sürücüleri ve servisler yüklenerek Windows başlatılır. Problem! Üzerinde bu kadar ince düşünülmüş bir sistemde ne gibi bir problem bulunabilir? Aslında biraz daha basit yaklaşmak gerekiyor. Yukarıda bulunan 3. maddeyi tekrar okuyun. Şifresi çözülmüş VMK sisteme geri gönderiliyor. Açık bir şekilde…\nTPM yongaları çeşitlerine göre veya üretinin tercihine göre sistemle LPC yani paralel ya da SPI yani seri olarak haberleşiyor. Anakart üzerinden Logic analyzer ya da FPGA gibi cihazlarla sniff edilebilen bu haberleşmede şifresi çözülmüş VMK elde edilebiliyor. İnanılmaz!\nHazırlık Yeteri kadar teknik detaya boğulduysak eğer artık kolları sıvamaya başlayabiliriz. Bu çalışmadaki amacımız Windows işletim sistemine sahip bir bilgisayarın BitLocker anahtarını fiziksel olarak sniff etmek. Ben kurban bilgisayar olarak bir Thinkpad (Tabii ki de) X1 Carbon tercih ettim. Bu bilgisayar ultra hafif yapısı, uzay endüstrisi sınıfındaki karbon fiber kasası ve 2K ekranı ile markanın en tepesinde konumlandırılan premium bir cihaz.\nLenovo Thinkpad X1 Carbon\nÖncelikle cihazımızı tanımamız gerekiyor. Neye, nasıl müdahale edeceğiz? Birincisi bilgisayarın üzerinde bulunan TPM yongasının belirlenmesi lazım. Bu yonga sistemle haberleşmek için hangi arabirimi kullanıyor? Bu cevapları vermemiz için bilgisayara ait datasheet’lerin incelenmesi gerekiyor. Bununla da kalmıyor, boardview şemalarının da gözden geçirilmesi gerekiyor. Eğer yeterince şanslıysanız bu şemalar internet ortamında bulunabiliyor fakat nadir modellerde maalesef ücretli satılması da mümkün.\nUyarı\nTPM yongasına veya anakart üzerindeki debug noktalarına erişmek için arka kapağın açılması gerekmektedir. Bu işlem cihazınızı garanti kapsamından çıkarabilir, dahası hiç çalışmamasına neden olabilir. Eğer ne yaptığınızı tam olarak bilmiyorsanız burdan sonra bahsedeceğim işlemler risk oluşturmaktadır zira ben bir tane T460 model dizüstü bilgisayarımın çalışmaz hale gelmesine neden oldum.\nDatasheet ve Boardview incelemesi Çalışmaya başlamamda bana ilham olan güvenlik araştırmacısı Thomas Roth veya takma adıyla stacksmashing, yaklaşık bir yıl kadar önce bu işe oldukça mesai harcamış ve LPC debug portu bulunan bilgisayarlardan saniyeler içerisinde VMK anahtarını elde etmeye aracılık eden bir devre kartı tasarlamış. TPM sniffing işlemi için tek yöntem bu değil fakat kesinlikle en kolayı. Farklı bilgisayarlar farklı arabirimlerle TPM çipiyle konuşabildiği gibi hepsinde bu debug portu bulunmuyor. Sahip olduğum bilgisayarın datasheet’ini incelerken bu porta sahip olduğunu gördüm ve heyecanla araştırmaya başladım.\nLPC debug portunun datasheet’i\nPorta ait detaylar görselde yer alırken ilginç bir ayrıntı daha bulunuyor. Portun numarası J7. Bu numarayı ilerde kullanacağız. Peki ne anlama geliyor. Devre şemaları üzerinde her harfin bir anlamı vardır. Rakamlar ise benzersizdir.\nC: Kapasitör R: Direnç L: Bobin Q: Transistör D: Diyot J: Jack ya da konnektör U: Entegre Bu harfler şema üzerinde C2, R5, J4 gibi rakamlar ile birlikte kullanılır. İlgili port bilgisayarımızda mevcut olduğuna göre sırada boardview incelemek var. Tabii ki öyle kolay ölüm yok. Burada da bir takım işlemler yapmaya devam edeceğiz. Bilgisayara ait datasheet’in yanında boardview’larına da ihtiyaç olduğundan bahsetmiştim. Bu boardview’ları açmak için hem ücretsiz hem de açık kaynak olduğu için OpenBoardView yazılımını tercih ettim. Bizim temin ettiğimiz boardview dosyası bv formatında fakat OpenBoardView bvr formatını destekliyor. Dosyayı çevirmek için minik bir linux hamlesine ihtiyaç duyacağız. Bu dönüştürmeyi yapan projeyi aşağıdaki komutlar yardımıyla indirip build ediyoruz.\ngit clone https://github.com/inflex/bv2bvr cd bv2bvr yum install glib glibc glib2 mdbtools-libs mdbtools-devel make ./bv2bvr ../x1_boardview.bv \u003e outputfile.bvr Dosyamızı OpenBoardView yazılımının desteklediği formata dönüştürdüğümüze göre içeriğini detaylıca inceleyebiliriz. Oldukça karmaşık görünen anakartın devre görüntüsünü biraz gözlemleyince J7 portunu bulmak çok da zor olmuyor.\nJ7 portunun boardview ve anakart üzerindeki konumu.\nBahsi geçen portu üretici benim plajda cep telefonumun üzerine havlu koymam misali bir etiketle çok profesyonelce gizlemiş. Etiketi kaldırdığımızda ihtiyacımız olan LPC debug header bizi karşılıyor ve heyecan katsayımız yükseliyor. Bu portu kullanarak TPM üzerindeki LPC iletişimini dinleyeceğiz.\nAnakart üzerindeki LPC debug header.\nDevre kartı Yukarıda da bahsettiğim gibi, açık trafiğin dinlenmesi için çok sayıda yöntem mevcut. Tercih tamamen hayalgücü ve yatkınlığınıza kalmış. TPM yongasının LPC ya da SPI arabirimine sahip olmasına göre Logic analyzer, FPGA kullanılabilir. Bunların dışında çok daha basit ve maliyeti düşük bir yöntem daha var. Raspberry Pico kullanmak. Bu ucuz ve mucizevi kart olmasa muhtemelen bana da blog içeriği çıkmayacaktı. Raspberry Pico görece ilkel bir cihaz olduğu için SPI iletişimini yakalamakta yetersiz olsa da LPC iletişimini dinlemekte oldukça iyi.\nAlman asıllı Thomas Roth isimli güvenlik araştırmacısı Raspberry Pico kullanarak LPC debug portunu dinlemeye yarayacak bir devre kartı tasarlamış ve kodlamasını yapmış. Dahası bu güvenlik zaafiyetini derinlemesine araştıran ilklerden birisi. Kendisini aynı zamanda enteresan çalışmalara imza atması ve fotoğrafçılığa olan ilgisinden dolayı uzun zamandır takip ediyorum. Proje detaylarına buradaki repodan ulaşabilirsiniz. Devre kartını toplayabilmek için ihtiyaç olanlar listesi oldukça mütevazi. Bir Raspberry Pico, 10 adet P50-B1-16mm pogo pin ve devre kartı. Repoda paylaşılan devre kartının çizimlerini JLCPCB sitesinden kargo ve gümrük dahil 15$ gibi bir rakama 5 tane bastırdım. İlgili site çizim olarak Gerber kabul ettiği için dönüştürme işleminde KiCad uygulamasından yardım aldım. Devre kartının toplanması için her ne kadar çok istekli olsam da ince işçilik gerektirdiği için profesyonel destek aldım.\nTPM sniffer devre kartı.\nSon olarak Raspberry Pico’nun programlaması işlemi kalıyor. Bu projedeki en önemli adımlardan biri çünkü yazdığımız ya da edindiğimiz kodun mikrodenetleyici tarafından çalıştırılabilir hale gelmesi için uygun biçimde derlenmiş olması şart. Derleme işlemi sırasında kaynak kodlar belirli bir derleyici aracılığıyla işlenerek Pico’nun anlayacağı makine diline çevriliyor. Derleme işlemi için tabii ki bir Linux tabanlı işletim sistemi kullanacağız.\nyum install epel-release yum install arm-none-eabi-gcc-cs arm-none-eabi-newlib arm-none-eabi-binutils arm-none-eabi-gdb git clone https://github.com/stacksmashing/pico-tpmsniffer git clone https://github.com/raspberrypi/pico-sdk export PICO_SDK_PATH=$(pwd)/pico-sdk cd pico-tpmsniffer mkdir build cd build cmake .. make Derleme işlemi başarıyla tamamlandığında projenin build dizini içerisinde .uf2 uzantılı bir dosya oluşacaktır. Bu dosya, Raspberry Pi Pico’ya yüklenmeye hazır olan çalıştırılabilir imaj dosyasıdır. Pico’yu programlama moduna almak için cihazın BOOTSEL butonuna basılı tutarak USB kablosu aracılığıyla bilgisayara bağlamanız gerekir. Bu işlemin ardından Pico harici bir USB depolama aygıtı gibi tanınacaktır. Son olarak, oluşturulan .uf2 dosyasını bu aygıta kopyaladığınızda yükleme işlemi otomatik olarak başlayacak ve kısa süre içinde tamamlanacaktır. Bu adımın ardından Pico cihazımız yüklediğiniz yeni yazılımla çalışmaya hazır hale gelecektir.\nOperasyon Sizce bu kadar hazırlığı boşuna mı yaptık? Balyozları getirin, kırıyoruz! İşlemin saniyeler süren aşamasına sonunda geldik. Benim aylarımı alan araştırma ve gereksinimleri tamamlama sürecinde şifrenin tek haneli saniyeler içerisinde elde edildiğine şahit olduğunuzda siz de şaşıracaksınız. Eğer bilgisayarın arka kapağının açılmasını saymazsak TPM iletişiminde VMK’nın dinlenmesi iyimser bir ifadeyle 10 saniyeden daha az sürüyor.\nDevre kartının debug header üzerine temas ettirilmesi.\nDevre kartının üzerine montajladığımız Raspberry cihazımızı bilgisayara bağladığımızda bir USB seri cihazı olarak tanınacaktır. Aygıta atanan COM portunu kullanarak bir terminal uygulaması ile standart hız ve ayarları kullanarak bağlanabiliriz. Bilgisayara bağlanan Raspberry Pico, çalışmaya hazır hale geliyor ve anakartın Debug nokasına temas ettirilmek üzere bekliyor. Devre kartımızı yukarına yerini tespit ettiğimiz LPC debug header’ine temas ettirip bilgisayarımızı boot ettiğimizde BitLocker anahtarı saniyeler içerisinde ekrana yansıyor.\n|_) o _ _ | | (_ (_) 88P'888'Y88 888 88e e e dP\"8 ,e, dP,e, dP,e, P' 888 'Y 888 888D d8b d8b C8b Y 888 8e \" 8b \" 8b \" ,e e, 888,8, 888 888 88\" e Y8b Y8b Y8b 888 88b 888 888888 888888 d88 88b 888 \" 888 888 d8b Y8b Y8b b Y8D 888 888 888 888 888 888 , 888 888 888 d888b Y8b Y8b 8edP 888 888 888 888 888 \"YeeP\" 888 Ready to sniff! Bitlocker Volume Master Key found: b0 a8 19 fc 9d b6 3f dd eb b7 c2 db 15 db bc a1 80 60 93 4f bd 0d de ac 76 bc 23 b0 47 59 56 fd Çıktıdan da tahmin edildiği üzere son iki satır VMK anahtarının hex halini ifade ediyor. Gerçekten çok kolay oldu. İşlem aşamaları şu şekilde; Pico içeren devre kartı USB aracılığıyla herhangi bir bilgisayara bağlanıyor ve bir terminal uygulaması ile seri arabirimine ulaşılıyor. Devre kartı, kurban bilgisayarın LPC debug header’ine temas ettiriliyor. Kurban bilgisayar Power butonu ile tetikleniyor. Sürpriz! Anahtar ekranda.\nBitLocker anahtarını elde ettiğimiz bilgisayarın şifreli diskini okumak için onu herhangi bir live işletim sistemiyle başlatabiliriz. İkinci bir seçenek olarak diski harici bir ortama bağlayabiliriz. Ben bilgisayarı Ubuntu 22.04 ile live başlatmayı tercih ettim. Block cihazları listelediğimde sda diskinin üçüncü partition’u yani /dev/sda3 yolu benim BitLocker ile şifrelenmiş diskimi ifade ediyordu.\nŞifrelenmiş diski anahtar kullanarak mount etmek için dislocker isimli araçtan faydalanıyoruz. Dislocker Ubuntu’nun universe reposunda bulunuyor. Normalde şifreli diski mount edebilmek için FVEK kullanan araç, 0.72 versiyonu ile VMK kullanabilme yeteneğine de kavuşmuş. HEX olarak elde ettiğimiz VMK’yı bir text dosyasına yazıyoruz ve boşluklarından kurtulduktan sonra binary’e dönüştürüyoruz.\ncat key.txt | tr -d '\\n ' | xxd -r -p \u003e key.bin\nAnahtarımızı binary haline getirdikten sonra dislocker ile devam ediyoruz. Dislocker aracına hangi diski, hangi VMK ile açacağını söyledikten sonra bize bir mount point oluşturuyor. Bu mount point’i kullanarak şifreli diskimizi istediğimiz bir yere bağlayabiliyoruz.\napt install dislocker dislocker -V /dev/sda3 --vmk key.bin -- /mnt/bitlocker mount -o ro,loop /mnt/bitlocker/dislocker-file /mnt/windows-decrypt Bitti! Aylar süren emek ve araştırmanın sonucunu saniyeler içerisinde tüketmek, güzel bir yemek için saatlerini verip dakikalar içerisinde bitirmeye benziyor. Gösterilen emek süresince alınan haz bir kenara, sonuç elde edince kazanılan tatmin ise çok daha farklı bir duygu.\nŞifrelenmiş diskin içeriği.\nSonuç Bu çalışmada, şifrelenmiş bir diske yapılan erişimleri donanım seviyesinde izleyerek kullanılan şifreyi ortaya çıkardık. Raspberry Pi Pico veya benzeri cihazlar ile yapılan bu tür düşük seviyeli müdahaleler yalnızca teknik bir başarı değil, aynı zamanda dijital sistemlerin fiziksel müdahaleler karşısında ne kadar savunmasız olabileceğini de gözler önüne seriyor. Özellikle TPM 2.0 ile birlikte kullanıma sunulan encrypted sessions komutları sayesinde işlemci ile TPM yongası arasındaki iletişim şifrelense de maalesef Windows işletim sistemi henüz bunu desteklemiyor. Üzülerek söylemeliyim ki piyasadaki bilgisayarların çok büyük kısmı risk altında. Peki önlem olarak ne yapabiliriz?\nKamuya açık riskli alanlarda bilgisayar çantamızın sırt bağını ayağımıza dolayabiliriz. Gayet ciddiyim. Özellikle Enterprise seviye bilgisayarlarda bulunan Preboot PIN özelliğini aktif edebiliriz. Bu özellik, disk boot edilmeden önce BIOS seviyesinde bir PIN talep ediyor. Thinkpad bilgisayarlarda bulunan Tamper Protection önlemini kullanabiliriz. Bilgisayarın içerisinde bulundan switch’ler sayesinde arka kapak açıldığında sistem çalışmayı reddediyor. Böylesine kompleks bir sistemin kolaylıkla aşılabilmesi tabii ki akıllara komplo teorilerini veya arka kapı sorularını getirecektir. Unutulmamalıdır ki güvenlik öncelikli olarak insan faktöründen başlar. En güçlü sistemler bile yanlış ellerde savunmasız hale gelebilir.\nBitLocker korumasını aştıktan sonra büründüğüm kişilik.\n","wordCount":"2749","inLanguage":"tr","image":"https://ciddikedi.com/posts/tpm/images/tpm_cover.jpg","datePublished":"2025-05-14T10:38:29+03:00","dateModified":"2025-05-14T10:38:29+03:00","author":{"@type":"Person","name":"Osman Bedrettin Yüce"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://ciddikedi.com/posts/tpm/"},"publisher":{"@type":"Organization","name":"ciddikedi","logo":{"@type":"ImageObject","url":"https://ciddikedi.com/images/favicon.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ciddikedi.com/ accesskey=h title="ciddikedi (Alt + H)"><img id=siteLogo src=https://ciddikedi.com/images/logo_dark.png alt=logo aria-label=logo height=35>
<script>document.body.className.includes("dark")&&(document.getElementById("siteLogo").src="/images/logo_light.png")</script>ciddikedi</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ciddikedi.com/ title=anasayfa><span>anasayfa</span></a></li><li><a href=https://ciddikedi.com/posts/ title=gönderiler><span>gönderiler</span></a></li><li><a href=https://ciddikedi.com/about/ title=hakkımda><span>hakkımda</span></a></li><li><a href=https://ciddikedi.com/search/ title="arama (Alt + /)" accesskey=/><span>arama</span></a></li><li><a href=https://seriouspaw.com title=seriouspaw.com><span>seriouspaw.com</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">BitLocker korumasını saniyeler içerisinde kırın!</h1><div class=post-meta><span title='2025-05-14 10:38:29 +0300 +03'>14 Mayıs, 2025</span>&nbsp;·&nbsp;13 dk&nbsp;·&nbsp;2749 kelime&nbsp;·&nbsp;Osman Bedrettin Yüce</div></header><figure class=entry-cover><img loading=eager src=https://ciddikedi.com/posts/tpm/images/tpm_cover.jpg alt="Pico TPMSniffer"></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>İçindekiler</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#giriş>Giriş</a></li><li><a href=#tpm-nedir>TPM nedir?</a><ul><li><a href=#nasıl-çalışır>Nasıl Çalışır?</a></li></ul></li><li><a href=#bitlocker>BitLocker</a><ul><li><a href=#tpm---bitlocker-ilişkisi>TPM - BitLocker ilişkisi</a></li><li><a href=#problem>Problem!</a></li></ul></li><li><a href=#hazırlık>Hazırlık</a><ul><li><a href=#datasheet-ve-boardview-incelemesi>Datasheet ve Boardview incelemesi</a></li><li><a href=#devre-kartı>Devre kartı</a></li></ul></li><li><a href=#operasyon>Operasyon</a></li><li><a href=#sonuç>Sonuç</a></li></ul></nav></div></details></div><div class=post-content><h2 id=giriş>Giriş<a hidden class=anchor aria-hidden=true href=#giriş>#</a></h2><p>Her yıl milyarlarca dolar siber güvenlik çözümlerine harcanıyor. Yazılımlar, bulut servisleri, yapay zeka destekli tehdit avcılığı gibi ileri teknolojilerle sistemler korunmaya çalışılıyor ancak tüm bu yüksek teknoloji çözümlerin gölgesinde fiziksel güvenlik çoğu zaman ikinci planda kalıyor. Kişisel olarak ben de kendi önlemlerimi alıyorum. Örneğin; Plajda cep telefonum fark edilmesin diye üzerini havlu ile örtüyorum veya yurtdışı seyahatlerimde pasaport cüzdan gibi değerli eşyaları sırt çantamın arka bölmelerinde saklıyorum. Benim amatör önlemlerim bir yana kişisel verilerimizi içeren teknolojik cihazlarımız istenmeyen ellere geçtiğinde mahremiyeti ve güvenliği sağlamak amacıyla tasarlanmış belli teknolojiler mevcut. Disk şifreleme bunlardan birisi. Microsoft tarafından sunulan BitLocker, her ne kadar diskteki veriyi bitlerine kadar şifrelese de dışardan yapılan fiziksel müdahalelerde nasıl aciz kalıyor beraber inceleyelim.</p><h2 id=tpm-nedir>TPM nedir?<a hidden class=anchor aria-hidden=true href=#tpm-nedir>#</a></h2><p>Günümüzde birçok bilgisayarın anakartında gömülü bulunan bu küçük yonga özellikle Windows 11 ile birlikte çok daha popüler hale geldi. TPM, yani Trusted Platform Module olarak adlandırılan bu donanım tabanlı güvenlik bileşeni, sistemin güvenliğini sağlamak için kriptografik anahtarları güvenli bir şekilde saklar ve kullanır. TPM, dijital dünyada bir nevi <strong>kasa</strong> görevi görür ve içerisine bir şey koyduğunuzda onu dışarıdan doğrudan almanız mümkün değildir. Ancak sistem uygun koşullar altında bu kasayı açabilir. BitLocker gibi disk şifreleme teknolojileri de tam bu noktada TPM’in sunduğu güvenlik garantilerinden faydalanır.</p><figure class=align-center><img loading=lazy src=images/tpm_diagram.png#center alt="ST33 yongasının donanım diyagramı. (Alıntı)"><figcaption><p>ST33 yongasının donanım diyagramı. (Alıntı)</p></figcaption></figure><p>Detaylarından daha ileride bahsedeceğim kurban bilgisayar, TPM olarak STMicroelectronics üretimi ST33ZP24AR28PVSP yongasını kullanıyor ve bu yonga basit bir devre elemanı olmaktan öte içerisinde 25 MHz hızında çalışan bir ARM SC300 işlemci barındırıyor. Yani TPM yongası sadece veri saklamıyor; aynı zamanda şifreleme, çözme ve kimlik doğrulama gibi işlemleri kendi içinde gerçekleştiriyor. Dolayısıyla bu durum TPM’in aktif bir güvenlik bileşeni olduğunun açık bir göstergesi.</p><p>Tasarlanan mimari, TPM’i bir nevi bağımsız bir güvenlik sistemi haline getiriyor. Başka bir deyişle sistemin güvenliği sadece işletim sisteminin veya uygulamaların kontrolüne bırakılmıyor, aynı zamanda donanım seviyesinde dış dünyadan izole bir işlemcinin kararlarına da bağlı oluyor. Kritik şifreleme ve şifre çözme işlemleri fiziksel olarak erişilemeyen dış müdahalelere karşı korumalı bir alanda gerçekleşiyor.</p><h3 id=nasıl-çalışır>Nasıl Çalışır?<a hidden class=anchor aria-hidden=true href=#nasıl-çalışır>#</a></h3><p>TPM yongasının aslında kendi başına ayrı bir cumhuriyet olduğundan bahsetmiştik. Tam olarak nasıl çalıştığını anlayabilmek için birkaç temel bileşen hakkında fikir sahibi olunması gerekiyor.</p><ul><li><p><strong>EK - Endorsement Key:</strong> Yonga üreticisi tarafından üretim sırasında donanım içerisine kalıcı olarak gömülen RSA anahtarıdır. Yonganın benzersiz olmasında rol oynar ve dışarı çıkartılamaz, değiştirilemez.</p></li><li><p><strong>SRK - Storage Root Key:</strong> TPM tarafından korunan tüm anahtarları şifrelemek için kullanılır. Cihaz ilk kurulduğunda oluşturulur ve dışarı çıkartılamaz. Değiştirilemez fakat yeniden üretilebilir.</p></li><li><p><strong>AK - Attestation Key:</strong> Sistemin açılış ölçümlerini imzalar ve güvenilirliğini doğrular. Değiştirilebilir ve yeniden oluşturulabilir.</p></li><li><p><strong>PCR - Platform Configuration Register:</strong> TPM üzerinde bulunan özel kayıt alanlarıdır. Sistemin açılış ölçümlerinin hash değerini tutar ve her açılışta teyit eder. Bu değerlerin içerisinde BIOS kodu, boot loader, Secure Boot gibi bilgiler yer alır ve eğer açılışta bu bilgiler eşleşmezse sistem açılmayı reddeder. Attestation Key bu alanı imzalar.</p></li><li><p><strong>RNG - Random Number Generator:</strong> Kriptografide tahmin edilemez rastgele sayı üretmek için kullanılır. Donanım temellidir ve anahtar üretimi, şifreleme işlemleri aşamalarında kullanılr.</p></li></ul><p>Bunların dışında TPM yongası verileri şifrelemek için bünyesinde hem simetrik algoritmalar hem de asimetrik algoritmalar için donanımsal motorları barındırır. Böylelikle şifreleme ve şifre çözme işlemleri hem daha hızlı olur hem de bağımsız bir ortamda gerçekleştirildiği için daha güvenli olur. Kendine ait kilobyte seviyesinde küçük de olsa bir RAM bulunan bu yonga, bünyesinde barındırdığı şifreleri hiçbir şekilde dışarı çıkartmaz.</p><h4 id=sealing-ve-unsealing>Sealing ve Unsealing<a hidden class=anchor aria-hidden=true href=#sealing-ve-unsealing>#</a></h4><p>TPM üzerinde sealing ve unsealing işlemleri, güvenli veri depolama ve veri koruma amacıyla kullanılan temel özelliklerdir. TPM&rsquo;nin en önemli özelliklerinden biri verilerin yalnızca güvenli bir ortamda yani belirli bir şartlar sağlandığında erişilebilir olmasını garanti eden sealing ve unsealing işlevleridir.</p><ul><li><p><strong>Sealing:</strong> Verileri TPM üzerinde SRK kullanarak şifreler ve sistemin son durumunu PCR üzerine kaydederek sistemin güvenliğini garanti altına alır. Bir kere çalıştırılır. Örneğin; BitLocker kurulumunda ihtiyaç duyulan şifreli anahtarın üretilmesi bir sealing işlemidir.</p></li><li><p><strong>Unsealing:</strong> Şifrelenmiş verinin TPM üzerinde çözülmesi işlemidir. Sealing işlemi sırasında oluşturulan PCR koşulları sağlanıyorsa TPM veriyi açar ve sistemin kullanımına sunar. Sistem her boot olduğunda şifrelenmiş diske ait anahtarı kullanabilmek için çalıştırılır.</p></li></ul><h2 id=bitlocker>BitLocker<a hidden class=anchor aria-hidden=true href=#bitlocker>#</a></h2><p>Windows işletim sistemlerinde kullanılan bir güvenlik özelliği olan BitLocker, disk üzerindeki verileri şifreler ve bilgisayarın çalınması veya bilgisayardaki diskin üçüncü şahısların eline geçmesi durumunda yetkisiz erişimin önüne geçer. Bilgisayara ait anakartın değiştirilmesi veya şifrelenmiş diskin farklı bir bilgisayara takılması durumunda sistem açılmayı reddeder. Güvenli ortam ve uygun koşullar sağlandığı sürece BitLocker, sisteme güvenerek disk alanını okunabilir hale getirir. Bu yöntemle yapılan şifreli disk okuma ve yazma işlemleri işlemcinin AES şifreleme hızlandırıcıları üzerinde yapılır ve performans kaybı göz ardı edilebilecek düzeydedir.</p><h3 id=tpm---bitlocker-ilişkisi>TPM - BitLocker ilişkisi<a hidden class=anchor aria-hidden=true href=#tpm---bitlocker-ilişkisi>#</a></h3><p>BitLocker esasında sadece bir disk şifreleme teknolojisi gibi gözükse de TPM gibi donanımsal bir güvenlik yongasıyla birlikte çalışır. TPM&rsquo;in bu noktada iki tane görevi vardır. Birincisi üzerindeki SRK&rsquo;yı kullanarak BitLocker anahtarını şifreler. İkinci görevi ise PCR koşullarını kontrol ederek sistem açıldığında şifrelenmiş anahtarı çözer. Biraz daha detaya girmek için bazı tanımlar hakkında fikir sahibi olmak gerekiyor.</p><ul><li><p><strong>FVEK - Full Volume Encryption Key:</strong> Diskteki verinin tamamını şifrelemek için kullanılan asıl anahtardır. Veri şifrelemede kullanıldığı için AES algoritmasını kullanır.</p></li><li><p><strong>VMK - Volume Master Key:</strong> Asıl disk şifreleme anahtarı olan FVEK&rsquo;i çözer. Diskin Volume Header&rsquo;inde şifrelenmiş olarak saklanır. Sistem boot ettiğinde TPM tarafından çözülür ve RSA algoritmasını kullanır.</p></li><li><p><strong>Recovery Key:</strong> BitLocker kurulumu sırasında kullanıcıya verilen 48 haneli özel kurtarma anahtarıdır. TPM yapılandırması bozulduğunda veya disk üzerindeki veriler kurtarılmak istendiğinde kullanılır. Recovery Key, şifrelenmiş VMK&rsquo;yı çözer.</p></li></ul><p>Kısacası daha anlaşılır olması amacıyla basite indirmek gerekirse şifrelenmiş diskin sırasıyla çözülme aşamaları aşağıdaki gibidir.</p><pre tabindex=0><code>Recovery Key: 48 haneli parola
Volume Header&#39;daki VMK bloğu: Şifreli VMK
Recovery Key + Şifreli VMK -&gt; Açık VMK
Açık VMK + Şifreli FVEK -&gt; Açık FVEK
Açık FVEK -&gt; NTFS verisi
</code></pre><p>Özet niteliğindeki bu açıklama konuyu genel hatlarıyla anlamamıza yardımcı oldu ancak konunun teknik yönünü daha derinlemesine incelemek isteyenler için şimdi sürecin bir de uzuncasını inceleyelim. Sistemimizin daha modern olduğunu varsayarak Legacy BIOS yerine UEFI sürecinden bahsedeceğim.</p><ol><li><strong>UEFI aşaması:</strong> Sistem güç verildiğinde çalışan ilk aşamadır. Temel donanımlar başlatılır ve bileşenler algılanır. Eğer şartlar uygunsa Boot Device Selection aşamasına geçilir. Boot edilecek disk bilgilerinin yanında bootloader bilgisi UEFI belleğinde saklanır. Aksi belirtilmediği sürece Windows için varsayılan boot manager <code>\EFI\Microsoft\Boot\bootmgfw.efi</code>yolundadır. UEFI uyumlu sistemler için FAT32 formatlı EFI partitionu olmak zorundadır ve eğer herhangi bir bootloader tanımı yapılmadıysa <code>\EFI\Boot\bootx64.efi</code>yolu varsayılan olarak kullanılır.<br> </li><li><strong>Boot Manager ve Loader:</strong> UEFI tarafından yüklenen <code>bootmgfw.efi</code>, hangi işletim sistemi veya hangi seçenekle devam edileceğine karar verir ve bootloader&rsquo;i yani <code>winload.efi</code>&lsquo;yi çalıştırır. Bootloader sistemin başlaması için temel sürücülerin yanında <code>fvevol.sys</code> yani Full Volume Encryption Driver&rsquo;i de belleğe yükler.<br> </li><li><strong>TPM ile şifre çözme:</strong> Disk şifreleme sürücüsü öncelikle mevcut diskin Volume Header&rsquo;ini okuyarak şifreli VMK&rsquo;yı TPM&rsquo;e gönderir ve şifre çözme talebinde bulunur. Eğer PCR üzerinde bulunan hash değerleri tutarlıysa diskteki şifreli VMK, TPM üzerindeki SRK kullanılarak çözülür ve sisteme geri gönderilir. Sürücü, şifresi çözülmüş VMK&rsquo;yı kullarak FVEK&rsquo;i çözer ve diski okunabilir hale getirir.<br> </li><li><strong>Windows yüklenmesi:</strong> Her şey uygun olduğuna göre artık disk üzerinde bulunan <code>ntoskrnl.exe</code> çekirdeği çalıştırılır ve kontrol işletim sistemine bırakılır. Donanım sürücüleri ve servisler yüklenerek Windows başlatılır.</li></ol><h3 id=problem>Problem!<a hidden class=anchor aria-hidden=true href=#problem>#</a></h3><p>Üzerinde bu kadar ince düşünülmüş bir sistemde ne gibi bir problem bulunabilir? Aslında biraz daha basit yaklaşmak gerekiyor. Yukarıda bulunan 3. maddeyi tekrar okuyun. Şifresi çözülmüş VMK sisteme geri gönderiliyor. Açık bir şekilde&mldr;</p><p>TPM yongaları çeşitlerine göre veya üretinin tercihine göre sistemle LPC yani paralel ya da SPI yani seri olarak haberleşiyor. Anakart üzerinden Logic analyzer ya da FPGA gibi cihazlarla sniff edilebilen bu haberleşmede şifresi çözülmüş VMK elde edilebiliyor. İnanılmaz!</p><h2 id=hazırlık>Hazırlık<a hidden class=anchor aria-hidden=true href=#hazırlık>#</a></h2><p>Yeteri kadar teknik detaya boğulduysak eğer artık kolları sıvamaya başlayabiliriz. Bu çalışmadaki amacımız Windows işletim sistemine sahip bir bilgisayarın BitLocker anahtarını fiziksel olarak sniff etmek. Ben kurban bilgisayar olarak bir Thinkpad (Tabii ki de) X1 Carbon tercih ettim. Bu bilgisayar ultra hafif yapısı, uzay endüstrisi sınıfındaki karbon fiber kasası ve 2K ekranı ile markanın en tepesinde konumlandırılan premium bir cihaz.</p><figure class=align-center><img loading=lazy src=images/x1_carbon.jpg#center alt="Lenovo Thinkpad X1 Carbon"><figcaption><p>Lenovo Thinkpad X1 Carbon</p></figcaption></figure><p>Öncelikle cihazımızı tanımamız gerekiyor. Neye, nasıl müdahale edeceğiz? Birincisi bilgisayarın üzerinde bulunan TPM yongasının belirlenmesi lazım. Bu yonga sistemle haberleşmek için hangi arabirimi kullanıyor? Bu cevapları vermemiz için bilgisayara ait datasheet&rsquo;lerin incelenmesi gerekiyor. Bununla da kalmıyor, boardview şemalarının da gözden geçirilmesi gerekiyor. Eğer yeterince şanslıysanız bu şemalar internet ortamında bulunabiliyor fakat nadir modellerde maalesef ücretli satılması da mümkün.</p><style type=text/css>.notice{--title-color:#fff;--title-background-color:#6be;--content-color:#444;--content-background-color:#e7f2fa}.notice.info{--title-background-color:#fb7;--content-background-color:#fec}.notice.tip{--title-background-color:#5a5;--content-background-color:#efe}.notice.warning{--title-background-color:#c33;--content-background-color:#fee}@media(prefers-color-scheme:dark){.notice{--title-color:#fff;--title-background-color:#069;--content-color:#ddd;--content-background-color:#023}.notice.info{--title-background-color:#a50;--content-background-color:#420}.notice.tip{--title-background-color:#363;--content-background-color:#121}.notice.warning{--title-background-color:#800;--content-background-color:#400}}body.dark .notice{--title-color:#fff;--title-background-color:#069;--content-color:#ddd;--content-background-color:#023}body.dark .notice.info{--title-background-color:#a50;--content-background-color:#420}body.dark .notice.tip{--title-background-color:#363;--content-background-color:#121}body.dark .notice.warning{--title-background-color:#800;--content-background-color:#400}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--content-color);background:var(--content-background-color)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background-color)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}</style><div class="notice warning"><p class=notice-title><span class="icon-notice baseline"><svg viewBox="126 76.5 300 300"><path d="M297.431 324.397v-34.255c0-3.245-2.344-5.95-5.358-5.95h-32.146c-3.014.0-5.358 2.705-5.358 5.95v34.255c0 3.245 2.344 5.95 5.358 5.95h32.146c3.014.0 5.358-2.705 5.358-5.95zm-.335-67.428 3.014-82.753c0-1.081-.502-2.524-1.674-3.425-1.005-.902-2.512-1.983-4.019-1.983h-36.834c-1.507.0-3.014 1.081-4.019 1.983-1.172.901-1.674 2.704-1.674 3.786l2.846 82.392c0 2.344 2.512 4.146 5.693 4.146h30.975c3.013.0 5.525-1.803 5.692-4.146zm-2.344-168.39L423.34 342.425c3.683 7.032 3.516 15.686-.335 22.717-3.85 7.031-10.883 11.358-18.417 11.358H147.413c-7.534.0-14.566-4.327-18.417-11.358-3.85-7.031-4.018-15.685-.335-22.716L257.248 88.578C260.93 81.188 268.13 76.5 276 76.5s15.069 4.688 18.752 12.08z"/></svg>
</span>Uyarı</p><p>TPM yongasına veya anakart üzerindeki debug noktalarına erişmek için arka kapağın açılması gerekmektedir. Bu işlem cihazınızı garanti kapsamından çıkarabilir, dahası hiç çalışmamasına neden olabilir.<br><br>Eğer ne yaptığınızı tam olarak bilmiyorsanız burdan sonra bahsedeceğim işlemler risk oluşturmaktadır zira ben bir tane T460 model dizüstü bilgisayarımın çalışmaz hale gelmesine neden oldum.</p></div><h3 id=datasheet-ve-boardview-incelemesi>Datasheet ve Boardview incelemesi<a hidden class=anchor aria-hidden=true href=#datasheet-ve-boardview-incelemesi>#</a></h3><p>Çalışmaya başlamamda bana ilham olan güvenlik araştırmacısı Thomas Roth veya takma adıyla stacksmashing, yaklaşık bir yıl kadar önce bu işe oldukça mesai harcamış ve LPC debug portu bulunan bilgisayarlardan saniyeler içerisinde VMK anahtarını elde etmeye aracılık eden bir devre kartı tasarlamış. TPM sniffing işlemi için tek yöntem bu değil fakat kesinlikle en kolayı. Farklı bilgisayarlar farklı arabirimlerle TPM çipiyle konuşabildiği gibi hepsinde bu debug portu bulunmuyor. Sahip olduğum bilgisayarın datasheet&rsquo;ini incelerken bu porta sahip olduğunu gördüm ve heyecanla araştırmaya başladım.</p><figure class=align-center><img loading=lazy src=images/lpc_datasheet.png#center alt="LPC debug portunun datasheet&rsquo;i"><figcaption><p>LPC debug portunun datasheet&rsquo;i</p></figcaption></figure><p>Porta ait detaylar görselde yer alırken ilginç bir ayrıntı daha bulunuyor. Portun numarası J7. Bu numarayı ilerde kullanacağız. Peki ne anlama geliyor. Devre şemaları üzerinde her harfin bir anlamı vardır. Rakamlar ise benzersizdir.</p><ul><li><strong>C:</strong> Kapasitör</li><li><strong>R:</strong> Direnç</li><li><strong>L:</strong> Bobin</li><li><strong>Q:</strong> Transistör</li><li><strong>D:</strong> Diyot</li><li><strong>J:</strong> Jack ya da konnektör</li><li><strong>U:</strong> Entegre</li></ul><p>Bu harfler şema üzerinde C2, R5, J4 gibi rakamlar ile birlikte kullanılır. İlgili port bilgisayarımızda mevcut olduğuna göre sırada boardview incelemek var. Tabii ki öyle kolay ölüm yok. Burada da bir takım işlemler yapmaya devam edeceğiz. Bilgisayara ait datasheet&rsquo;in yanında boardview&rsquo;larına da ihtiyaç olduğundan bahsetmiştim. Bu boardview&rsquo;ları açmak için hem ücretsiz hem de açık kaynak olduğu için OpenBoardView yazılımını tercih ettim. Bizim temin ettiğimiz boardview dosyası <code>bv</code> formatında fakat OpenBoardView <code>bvr</code> formatını destekliyor. Dosyayı çevirmek için minik bir linux hamlesine ihtiyaç duyacağız. Bu dönüştürmeyi yapan projeyi aşağıdaki komutlar yardımıyla indirip build ediyoruz.</p><pre tabindex=0><code>git clone https://github.com/inflex/bv2bvr
cd bv2bvr
yum install glib glibc glib2 mdbtools-libs mdbtools-devel
make
./bv2bvr ../x1_boardview.bv &gt; outputfile.bvr
</code></pre><p>Dosyamızı OpenBoardView yazılımının desteklediği formata dönüştürdüğümüze göre içeriğini detaylıca inceleyebiliriz. Oldukça karmaşık görünen anakartın devre görüntüsünü biraz gözlemleyince J7 portunu bulmak çok da zor olmuyor.</p><figure class=align-center><img loading=lazy src=images/j7_header.jpg#center alt="J7 portunun boardview ve anakart üzerindeki konumu."><figcaption><p>J7 portunun boardview ve anakart üzerindeki konumu.</p></figcaption></figure><p>Bahsi geçen portu üretici benim plajda cep telefonumun üzerine havlu koymam misali bir etiketle çok profesyonelce gizlemiş. Etiketi kaldırdığımızda ihtiyacımız olan LPC debug header bizi karşılıyor ve heyecan katsayımız yükseliyor. Bu portu kullanarak TPM üzerindeki LPC iletişimini dinleyeceğiz.</p><figure class=align-center><img loading=lazy src=images/lpc_debug.jpg#center alt="Anakart üzerindeki LPC debug header."><figcaption><p>Anakart üzerindeki LPC debug header.</p></figcaption></figure><h3 id=devre-kartı>Devre kartı<a hidden class=anchor aria-hidden=true href=#devre-kartı>#</a></h3><p>Yukarıda da bahsettiğim gibi, açık trafiğin dinlenmesi için çok sayıda yöntem mevcut. Tercih tamamen hayalgücü ve yatkınlığınıza kalmış. TPM yongasının LPC ya da SPI arabirimine sahip olmasına göre Logic analyzer, FPGA kullanılabilir. Bunların dışında çok daha basit ve maliyeti düşük bir yöntem daha var. Raspberry Pico kullanmak. Bu ucuz ve mucizevi kart olmasa muhtemelen bana da blog içeriği çıkmayacaktı. Raspberry Pico görece ilkel bir cihaz olduğu için SPI iletişimini yakalamakta yetersiz olsa da LPC iletişimini dinlemekte oldukça iyi.</p><p>Alman asıllı Thomas Roth isimli güvenlik araştırmacısı Raspberry Pico kullanarak LPC debug portunu dinlemeye yarayacak bir devre kartı tasarlamış ve kodlamasını yapmış. Dahası bu güvenlik zaafiyetini derinlemesine araştıran ilklerden birisi. Kendisini aynı zamanda enteresan çalışmalara imza atması ve fotoğrafçılığa olan ilgisinden dolayı uzun zamandır takip ediyorum. Proje detaylarına <a href=https://github.com/stacksmashing/pico-tpmsniffer>buradaki</a> repodan ulaşabilirsiniz. Devre kartını toplayabilmek için ihtiyaç olanlar listesi oldukça mütevazi. Bir Raspberry Pico, 10 adet P50-B1-16mm pogo pin ve devre kartı. Repoda paylaşılan devre kartının çizimlerini JLCPCB sitesinden kargo ve gümrük dahil 15$ gibi bir rakama 5 tane bastırdım. İlgili site çizim olarak Gerber kabul ettiği için dönüştürme işleminde KiCad uygulamasından yardım aldım. Devre kartının toplanması için her ne kadar çok istekli olsam da ince işçilik gerektirdiği için profesyonel destek aldım.</p><figure class=align-center><img loading=lazy src=images/tpm_sniffer.jpg#center alt="TPM sniffer devre kartı."><figcaption><p>TPM sniffer devre kartı.</p></figcaption></figure><p>Son olarak Raspberry Pico&rsquo;nun programlaması işlemi kalıyor. Bu projedeki en önemli adımlardan biri çünkü yazdığımız ya da edindiğimiz kodun mikrodenetleyici tarafından çalıştırılabilir hale gelmesi için uygun biçimde derlenmiş olması şart. Derleme işlemi sırasında kaynak kodlar belirli bir derleyici aracılığıyla işlenerek Pico’nun anlayacağı makine diline çevriliyor. Derleme işlemi için tabii ki bir Linux tabanlı işletim sistemi kullanacağız.</p><pre tabindex=0><code>yum install epel-release
yum install arm-none-eabi-gcc-cs arm-none-eabi-newlib arm-none-eabi-binutils arm-none-eabi-gdb
git clone https://github.com/stacksmashing/pico-tpmsniffer
git clone https://github.com/raspberrypi/pico-sdk
export PICO_SDK_PATH=$(pwd)/pico-sdk
cd pico-tpmsniffer
mkdir build
cd build
cmake ..
make
</code></pre><p>Derleme işlemi başarıyla tamamlandığında projenin build dizini içerisinde <code>.uf2</code> uzantılı bir dosya oluşacaktır. Bu dosya, Raspberry Pi Pico’ya yüklenmeye hazır olan çalıştırılabilir imaj dosyasıdır. Pico’yu programlama moduna almak için cihazın <strong>BOOTSEL</strong> butonuna basılı tutarak USB kablosu aracılığıyla bilgisayara bağlamanız gerekir. Bu işlemin ardından Pico harici bir USB depolama aygıtı gibi tanınacaktır. Son olarak, oluşturulan <code>.uf2</code> dosyasını bu aygıta kopyaladığınızda yükleme işlemi otomatik olarak başlayacak ve kısa süre içinde tamamlanacaktır. Bu adımın ardından Pico cihazımız yüklediğiniz yeni yazılımla çalışmaya hazır hale gelecektir.</p><h2 id=operasyon>Operasyon<a hidden class=anchor aria-hidden=true href=#operasyon>#</a></h2><p>Sizce bu kadar hazırlığı boşuna mı yaptık? Balyozları getirin, kırıyoruz! İşlemin saniyeler süren aşamasına sonunda geldik. Benim aylarımı alan araştırma ve gereksinimleri tamamlama sürecinde şifrenin tek haneli saniyeler içerisinde elde edildiğine şahit olduğunuzda siz de şaşıracaksınız. Eğer bilgisayarın arka kapağının açılmasını saymazsak TPM iletişiminde VMK&rsquo;nın dinlenmesi iyimser bir ifadeyle 10 saniyeden daha az sürüyor.</p><figure class=align-center><img loading=lazy src=images/raspberry_on_mb.jpg#center alt="Devre kartının debug header üzerine temas ettirilmesi."><figcaption><p>Devre kartının debug header üzerine temas ettirilmesi.</p></figcaption></figure><p>Devre kartının üzerine montajladığımız Raspberry cihazımızı bilgisayara bağladığımızda bir USB seri cihazı olarak tanınacaktır. Aygıta atanan COM portunu kullanarak bir terminal uygulaması ile standart hız ve ayarları kullanarak bağlanabiliriz. Bilgisayara bağlanan Raspberry Pico, çalışmaya hazır hale geliyor ve anakartın Debug nokasına temas ettirilmek üzere bekliyor. Devre kartımızı yukarına yerini tespit ettiğimiz LPC debug header&rsquo;ine temas ettirip bilgisayarımızı boot ettiğimizde BitLocker anahtarı saniyeler içerisinde ekrana yansıyor.</p><pre tabindex=0><code>|_) o  _  _
|   | (_ (_)

88P&#39;888&#39;Y88 888 88e    e   e        dP&#34;8         ,e,  dP,e,  dP,e,
P&#39;  888  &#39;Y 888 888D  d8b d8b      C8b Y 888 8e   &#34;   8b &#34;   8b &#34;   ,e e,  888,8,
    888     888 88&#34;  e Y8b Y8b      Y8b  888 88b 888 888888 888888 d88 88b 888 &#34;
    888     888     d8b Y8b Y8b    b Y8D 888 888 888  888    888   888   , 888
    888     888    d888b Y8b Y8b   8edP  888 888 888  888    888    &#34;YeeP&#34; 888

Ready to sniff!
Bitlocker Volume Master Key found:
b0 a8 19 fc 9d b6 3f dd  eb b7 c2 db 15 db bc a1
80 60 93 4f bd 0d de ac  76 bc 23 b0 47 59 56 fd
</code></pre><p>Çıktıdan da tahmin edildiği üzere son iki satır VMK anahtarının hex halini ifade ediyor. Gerçekten çok kolay oldu. İşlem aşamaları şu şekilde; Pico içeren devre kartı USB aracılığıyla herhangi bir bilgisayara bağlanıyor ve bir terminal uygulaması ile seri arabirimine ulaşılıyor. Devre kartı, kurban bilgisayarın LPC debug header&rsquo;ine temas ettiriliyor. Kurban bilgisayar Power butonu ile tetikleniyor. Sürpriz! Anahtar ekranda.</p><p>BitLocker anahtarını elde ettiğimiz bilgisayarın şifreli diskini okumak için onu herhangi bir live işletim sistemiyle başlatabiliriz. İkinci bir seçenek olarak diski harici bir ortama bağlayabiliriz. Ben bilgisayarı Ubuntu 22.04 ile live başlatmayı tercih ettim. Block cihazları listelediğimde <code>sda</code> diskinin üçüncü partition&rsquo;u yani <code>/dev/sda3</code> yolu benim BitLocker ile şifrelenmiş diskimi ifade ediyordu.</p><p>Şifrelenmiş diski anahtar kullanarak mount etmek için <strong>dislocker</strong> isimli araçtan faydalanıyoruz. Dislocker Ubuntu&rsquo;nun universe reposunda bulunuyor. Normalde şifreli diski mount edebilmek için FVEK kullanan araç, 0.72 versiyonu ile VMK kullanabilme yeteneğine de kavuşmuş. HEX olarak elde ettiğimiz VMK&rsquo;yı bir text dosyasına yazıyoruz ve boşluklarından kurtulduktan sonra binary&rsquo;e dönüştürüyoruz.</p><p><code>cat key.txt | tr -d '\n ' | xxd -r -p > key.bin</code></p><p>Anahtarımızı binary haline getirdikten sonra dislocker ile devam ediyoruz. Dislocker aracına hangi diski, hangi VMK ile açacağını söyledikten sonra bize bir mount point oluşturuyor. Bu mount point&rsquo;i kullanarak şifreli diskimizi istediğimiz bir yere bağlayabiliyoruz.</p><pre tabindex=0><code>apt install dislocker
dislocker -V /dev/sda3 --vmk key.bin -- /mnt/bitlocker
mount -o ro,loop /mnt/bitlocker/dislocker-file /mnt/windows-decrypt
</code></pre><p>Bitti! Aylar süren emek ve araştırmanın sonucunu saniyeler içerisinde tüketmek, güzel bir yemek için saatlerini verip dakikalar içerisinde bitirmeye benziyor. Gösterilen emek süresince alınan haz bir kenara, sonuç elde edince kazanılan tatmin ise çok daha farklı bir duygu.</p><figure class=align-center><img loading=lazy src=images/list_files.png#center alt="Şifrelenmiş diskin içeriği."><figcaption><p>Şifrelenmiş diskin içeriği.</p></figcaption></figure><h2 id=sonuç>Sonuç<a hidden class=anchor aria-hidden=true href=#sonuç>#</a></h2><p>Bu çalışmada, şifrelenmiş bir diske yapılan erişimleri donanım seviyesinde izleyerek kullanılan şifreyi ortaya çıkardık. Raspberry Pi Pico veya benzeri cihazlar ile yapılan bu tür düşük seviyeli müdahaleler yalnızca teknik bir başarı değil, aynı zamanda dijital sistemlerin fiziksel müdahaleler karşısında ne kadar savunmasız olabileceğini de gözler önüne seriyor. Özellikle TPM 2.0 ile birlikte kullanıma sunulan <strong>encrypted sessions</strong> komutları sayesinde işlemci ile TPM yongası arasındaki iletişim şifrelense de maalesef Windows işletim sistemi henüz bunu desteklemiyor. Üzülerek söylemeliyim ki piyasadaki bilgisayarların çok büyük kısmı risk altında. Peki önlem olarak ne yapabiliriz?</p><ul><li>Kamuya açık riskli alanlarda bilgisayar çantamızın sırt bağını ayağımıza dolayabiliriz. Gayet ciddiyim.</li><li>Özellikle Enterprise seviye bilgisayarlarda bulunan Preboot PIN özelliğini aktif edebiliriz. Bu özellik, disk boot edilmeden önce BIOS seviyesinde bir PIN talep ediyor.</li><li>Thinkpad bilgisayarlarda bulunan Tamper Protection önlemini kullanabiliriz. Bilgisayarın içerisinde bulundan switch&rsquo;ler sayesinde arka kapak açıldığında sistem çalışmayı reddediyor.</li></ul><p>Böylesine kompleks bir sistemin kolaylıkla aşılabilmesi tabii ki akıllara komplo teorilerini veya arka kapı sorularını getirecektir. Unutulmamalıdır ki güvenlik öncelikli olarak insan faktöründen başlar. En güçlü sistemler bile yanlış ellerde savunmasız hale gelebilir.</p><figure class=align-center><img loading=lazy src=images/neo.jpg#center alt="BitLocker korumasını aştıktan sonra büründüğüm kişilik."><figcaption><p>BitLocker korumasını aştıktan sonra büründüğüm kişilik.</p></figcaption></figure></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://ciddikedi.com/posts/dialup/><span class=title>Sonraki »</span><br><span>Dialing... 2025 yılına Dial-up ile bağlanıyoruz!</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ciddikedi.com/>ciddikedi</a></span> ·
<span>Osman Bedrettin Yüce</span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light"),document.getElementById("siteLogo").src="/images/logo_dark.png"):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"),document.getElementById("siteLogo").src="/images/logo_light.png")})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Kopyala";function s(){t.innerHTML="Kopyalandı!",setTimeout(()=>{t.innerHTML="Kopyala"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>